# 粒子形状参数调整总结

## 修改目的
优化粒子生成算法，使生成的粒子形状更"奇怪"和不规则，避免平滑椭球形态。

## 修改位置
文件：`particle_generator.py`
函数：`generate_random_particle_params()`
分支：`category == 'regular'` （第 52-61 行）

## 具体修改内容

### 1. Form 参数调整（打破球体感）

| 参数 | 原始范围 | 新范围 | 说明 |
|------|---------|--------|------|
| **Ei** (Elongation Index) | 0.8 - 1.0 | **0.4 - 0.7** | 大幅降低，产生强烈的拉长感，破坏球形 |
| **Fi** (Flatness Index) | 0.7 - 0.95 | **0.4 - 0.7** | 大幅降低，产生明显的压扁感 |

**效果**：粒子不再接近球形，而是呈现明显的非球形体、椭球体或不规则形态

---

### 2. Roundness 增强（增加棱角和宏观凹凸）

| 参数 | 原始范围 | 新范围 | 说明 |
|------|---------|--------|------|
| **D2_8** (2-8阶球谐系数) | 0.0 - 0.3 | **0.2 - 0.45** | 增大范围，增强权重（最小值从0.0→0.2），产生明显的棱角 |

**效果**：
- 2-8阶球谐分量权重大幅增加
- 产生宏观尺度的凹凸和棱角特征
- 粒子不再光滑，具有明显的几何形状特征

---

### 3. Roughness 增加（增加表面粗糙度）

| 参数 | 原始范围 | 新范围 | 说明 |
|------|---------|--------|------|
| **D9_15** (9-15阶球谐系数) | 0.0 - 0.1 | **0.08 - 0.25** | 扩大范围并提升基础值，增加表面纹理 |

**效果**：
- 高频表面特征振幅增加
- 表面产生更明显的粗糙质感、凹凸和微观特征
- 增强粒子表面的纹理细节

---

### 4. 辅助参数调整

| 参数 | 原始范围 | 新范围 | 说明 |
|------|---------|--------|------|
| **max_degree** | 8 - 12 | **12 - 17** | 增加球谐展开阶数，允许更复杂的几何细节 |
| **coeff_multiplier** | 1.0 | **1.2** | 固定为 1.2（原为 1.0），轻微放大系数以增强特征 |

---

## 生成效果对比

### 原始参数生成的粒子特征
- 基本形态：近似球形或光滑椭球
- 表面：光滑
- 整体感受：规则、平滑、自然

### 修改后参数生成的粒子特征
- 基本形态：明显的非球形、压扁或拉长
- 表面：粗糙、有明显凹凸、棱角
- 整体感受：奇特、不规则、"怪异"、更像自然砾石

---

## 测试验证

运行 `test_params.py` 验证参数范围，结果显示所有参数都在预期范围内：
- ? Ei: 0.4 - 0.7
- ? Fi: 0.4 - 0.7  
- ? D2_8: 0.2 - 0.45
- ? D9_15: 0.08 - 0.25
- ? max_degree: 12 - 17
- ? coeff_multiplier: 1.2

---

## 注意事项

1. **weird 分支未改动**：只修改了 `regular` 分支，`weird` 分支参数保持不变（用于生成极端形状）
2. **向后兼容**：修改仅影响参数范围，不影响函数接口
3. **运行方式**：直接运行 `python run_competition_generation.py` 即可使用新参数
4. **还原方法**：如需还原，参考注释中的原始参数范围

